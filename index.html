<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>VR Based Education</title>
    <meta name="description" content="Web2VR">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="./assets/js/aframe.min.js"></script>
    <script src="./assets/js/quickxr.js"></script>
    <script src="./assets/js/gradientsky.min.js"></script>

    <link rel="stylesheet" href="./assets/css/style.css">
</head>

<body>
    <div id="html-container">

        <h1>VR-Based Education With STIR and TURB</h1>

        <div id="formContainer">
            <input type="text" id="videoId" placeholder="Enter Youtube Video ID" value="" />
            <button id="submitYoutubeId" type="button">Submit</button>
        </div>

        <span id="liveStatus">Enter the Video ID</span>

        <div id="content">

        </div>


    </div>

    <a-scene renderer="colorManagement:true;" shadow="type: pcfsoft">
        <a-sky material="shader: gradient; topColor: 0 0 0; bottomColor: 1 41 100 ; offset: 600"
            geometry="radius: 1000"></a-sky>
    </a-scene>

    <script>

        const web2vr = new Web2VR("#html-container", {
            position: {
                x: 0,
                y: 2.1,
                z: -0.6
            },
        })
        web2vr.start()

        // load the video if the button is pressed
        document.getElementById("submitYoutubeId").addEventListener("click", async () => {


            let videoId = document.getElementById("videoId").value

            if (videoId) {

                document.getElementById("formContainer").innerHTML = ""

                let videoTag = `<video id="video" src="https://relay-youtube.adaptable.app/${videoId}" width="640" height="360" controls crossorigin></video>`

                document.getElementById("content").innerHTML = videoTag

                document.getElementById("liveStatus").innerHTML = `Status: Generating Questions...`


                let questions = await fetch("https://youtube-questions.onrender.com", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({
                        "youtubeVideoId": videoId
                    })
                })

                questions = await questions.json()

                document.getElementById("liveStatus").innerHTML = `Status: Questions Generated`

                let questionsHTML = `<div id="questionsContainer">`
                questionsHTML += `<div id="questions">`
                questions.forEach((question, index) => {
                    questionsHTML += `<span>${question}</span>`
                    questionsHTML += `<input type="text" data-id="${index + 1}" placeholder="Enter Answer" />`
                })
                questionsHTML += `</div>`
                questionsHTML += `<button id="submitAnswer" type="button">Submit</button>`
                questionsHTML += `</div>`

                document.getElementById("content").innerHTML += questionsHTML


            }

        })

    </script>
</body>

</html>